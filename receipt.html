<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>결제 완료 | The Plastic Dining</title>
  <style>
    html, body { height: 100% }
    body {
      margin: 0;
      overflow: hidden;
      display: grid;
      place-items: center;
      background: #000; /* 로딩/폴백 */
    }

    /* 배경 이미지 */
    .bg {
      position: fixed;
      inset: 0;
      background: #000 center/cover no-repeat;
      filter: blur(1px) brightness(.85);
      transform: scale(1.02);
      z-index: 0;
    }

    /* 홈 버튼(우상단) */
    .home-btn{
      position: fixed;
      top: 18px;
      right: 22px;
      z-index: 2;
      display: inline-flex;
      padding: 6px;
      border-radius: 10px;
      background: rgba(0,0,0,.35);
      backdrop-filter: blur(2px);
    }
    .home-btn img{
      width: 34px; height: 34px; display: block;
      filter: invert(1) brightness(.9);
    }

    /* 중앙에 영수증 */
    .stage{
      position: relative;
      z-index: 1;
      display: grid;
      place-items: center;
      width: 100vw; height: 100vh;
      pointer-events: none;
    }
    .receipt{
      max-width: 340px;   /* 데스크톱 크기 */
      width: 54vw;        /* 반응형 */
      height: auto;
      display: block;
      box-shadow: 0 10px 40px rgba(0,0,0,.55);
      border-radius: 2px;
      user-select: none; -webkit-user-drag: none;
    }
    @media (max-width:480px){
      .receipt{ width: 82vw; max-width: 430px; }
    }

    /* ===== 인쇄용 스타일 ===== */
    @media print {
      html, body {
        height: auto;
        background: #fff !important;
      }
      body {
        margin: 0;
        overflow: visible;
        display: block;
        place-items: initial;
      }
      .bg,
      .home-btn {
        display: none !important; /* 배경, 홈버튼 숨기기 */
      }
      .stage {
        width: 100%;
        height: auto;
        display: block;
      }
      .receipt {
        width: 100%;
        max-width: none;
        box-shadow: none;
        border-radius: 0;
      }
    }
  </style>
</head>
<body>
  <div class="bg" id="bg"></div>

  <!-- 홈 버튼 -->
  <a href="index.html" class="home-btn" aria-label="홈으로 이동" title="Home">
    <img src="img/icon/home.png" alt="">
  </a>

  <div class="stage">
    <img id="receiptImg" class="receipt" src="" alt="결제 영수증">
  </div>

  <script>
    (function () {
      const params = new URLSearchParams(location.search);
      const item = params.get('item') || 'salad_gardenbag';

      const BG_PATH = 'img/receipt/receipt_background.png';
      const RC_PATH = `img/receipt/${item}_receipt.png`;

      // 배경
      document.getElementById('bg').style.backgroundImage = `url('${BG_PATH}')`;

      // 영수증 이미지 세팅
      const receipt = document.getElementById('receiptImg');
      receipt.src = RC_PATH;
      receipt.onerror = function () {
        this.onerror = null;
        this.src = 'img/receipt/salad_gardenbag_receipt.png';
      };

      // 이미지가 로드되면 인쇄창 자동 오픈 (Ctrl+P와 동일)
      function triggerPrint() {
        // 살짝 딜레이 주면 렌더링이 안정적
        setTimeout(() => window.print(), 200);
      }

      receipt.addEventListener('load', triggerPrint);

      // 캐시된 이미지로 이미 로드 완료 상태일 수도 있어서 한 번 더 확인
      if (receipt.complete) {
        triggerPrint();
      }
    })();
  </script>
</body>
</html>
